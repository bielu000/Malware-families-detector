//
// Created by pp on 13.01.19.
//

#include <opencv2/core/mat.hpp>
#include <opencv2/core.hpp>
#include "../includes/StandardScaler.hpp"
#include "../../errors.hpp"
#include "../../exception.h"

void StandardScaler::transform(cv::Mat &data)
{
    if (_mean == 0.0 && _std == 0.0) {
        cv::Mat meanMat;
        cv::Mat stdMat;

        cv::meanStdDev(data, meanMat, stdMat);

        _mean = meanMat.at<double>(0, 0);
        _std = stdMat.at<double>(0, 0);
    }

    if (_std == 0.0) {
        throw app_exception(errors::codes::std_is_zero_value);
    }

    data -= _mean;
    data /= _std;
}