//
// Created by pp on 12.01.19.
//

#include "../includes/SVCDomainClassifier.hpp"
#include "../../exception.hpp"

void SVCDomainClassifier::train(const cv::Mat &trainData, const cv::Mat &labels)
{
    _detectingModel->trainAuto(trainData, cv::ml::ROW_SAMPLE, labels);
}

float SVCDomainClassifier::predict(const cv::Mat& testData)
{
    if (!isTrained()) {
        throw app_exception(errors::codes::domain_classifier_not_init, "Milticlass classifer is not loaded");
    }

    auto result = _detectingModel->predict(testData, cv::noArray());

    return result;

}

void SVCDomainClassifier::load(const std::string& filepath)
{
    _detectingModel->load(filepath);
}

void SVCDomainClassifier::save(const std::string &filepath)
{
    _detectingModel->save(filepath);
}

bool SVCDomainClassifier::isTrained()
{
    return _detectingModel->isTrained();
}
