#include <QtCore/QTextStream>
#include "../include/configdialog.hpp"
#include "ui_configdialog.h"

ConfigDialog::ConfigDialog(QWidget *parent) :
    QDialog(parent),
    ui(new Ui::ConfigDialog)
{
    ui->setupUi(this);
}

ConfigDialog::ConfigDialog(const std::vector<Config> &configs, QWidget *parent)
    : ConfigDialog(parent)
{
    _configs = configs;

    for (auto const& x : configs) {
        QString str;
        QTextStream stream(&str);
        stream << "Identyfikator konfiguracji: " << QString::fromUtf8(x.id.data(), static_cast<int>(x.id.size()));

        ui->listWidget->addItem(str);
    }
}

ConfigDialog::~ConfigDialog()
{
    delete ui;
}

void ConfigDialog::on_closePushButton_clicked()
{
    reject();
}

void ConfigDialog::on_detailsPushButton_clicked()
{

}

void ConfigDialog::on_loadPushButton_clicked()
{
    auto idx = ui->listWidget->currentRow();
    auto cfg = _configs[idx];
    _selectedId = cfg.id;

    done(ConfigSelected);
}

std::string ConfigDialog::getSelectedConfigId()
{
    return _selectedId;
}